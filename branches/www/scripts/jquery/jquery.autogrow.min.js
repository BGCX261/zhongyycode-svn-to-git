$.fn.autogrow=function(e){this.filter('textarea').each(function(){var a={minLines:$(this).attr('rows'),lineHeight:18,overflow:'hidden',restore:true};$.extend(a,e);if(isNaN(a.minLines)||a.minLines<1){a.minLines=10}var b=a.lineHeight*a.minLines;if($.browser.msie){b=parseInt(b)-1}$(this).height(b).css('overflow',a.overflow).css('lineHeight',a.lineHeight+'px');var c=$('<div></div>').css({'fontSize':$(this).css('fontSize'),'fontFamily':$(this).css('fontFamily'),'lineHeight':a.lineHeight+'px','width':this.clientWidth,'overflowX':'hidden','position':'absolute','top':0,'left':-9999}).appendTo('body');var d=function(){c.html($(this).val().replace(/(<|>)/g,'').replace(/\n/g,'<br />new'));$(this).height(Math.max(b,parseInt(c.height())))};$(this).change(d).keyup(d).keydown(d).click(d);if(a.restore){$(this).blur(function(){$(this).css('height',b)})}});return this};