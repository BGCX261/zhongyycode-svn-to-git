(function($){$.fn.editable=function(l,m){var n={target:l,name:'value',id:'id',type:'text',width:'auto',height:'auto',event:'click',onblur:'cancel',loadtype:'GET',loadtext:'Loading...',placeholder:'Click to edit',loaddata:{},submitdata:{}};if(m){$.extend(n,m)}var o=$.editable.types[n.type].plugin||function(){};var p=$.editable.types[n.type].submit||function(){};var q=$.editable.types[n.type].buttons||$.editable.types['defaults'].buttons;var r=$.editable.types[n.type].content||$.editable.types['defaults'].content;var s=$.editable.types[n.type].element||$.editable.types['defaults'].element;var u=$.editable.types[n.type].reset||$.editable.types['defaults'].reset;var v=n.callback||function(){};if(!$.isFunction($(this)[n.event])){$.fn[n.event]=function(a){return a?this.bind(n.event,a):this.trigger(n.event)}}$(this).attr('title',n.tooltip);n.autowidth='auto'==n.width;n.autoheight='auto'==n.height;return this.each(function(){var i=this;var j=$(i).width();var k=$(i).height();if(!$.trim($(this).html())){$(this).html(n.placeholder)}$(this)[n.event](function(e){if(i.editing){return}if(0==$(i).width()){n.width=j;n.height=k}else{if(n.width!='none'){n.width=n.autowidth?$(i).width():n.width}if(n.height!='none'){n.height=n.autoheight?$(i).height():n.height}}if($(this).html().toLowerCase().replace(/;/,'')==n.placeholder.toLowerCase().replace(/;/,'')){$(this).html('')}i.editing=true;i.revert=$(i).html();$(i).html('');var d=$('<form/>');if(n.cssclass){if('inherit'==n.cssclass){d.attr('class',$(i).attr('class'))}else{d.attr('class',n.cssclass)}}if(n.style){if('inherit'==n.style){d.attr('style',$(i).attr('style'));d.css('display',$(i).css('display'))}else{d.attr('style',n.style)}}var f=s.apply(d,[n,i]);var g;if(n.loadurl){var t=setTimeout(function(){f.disabled=true;r.apply(d,[n.loadtext,n,i])},100);var h={};h[n.id]=i.id;if($.isFunction(n.loaddata)){$.extend(h,n.loaddata.apply(i,[i.revert,n]))}else{$.extend(h,n.loaddata)}$.ajax({type:n.loadtype,url:n.loadurl,data:h,async:false,success:function(a){window.clearTimeout(t);g=a;f.disabled=false}})}else if(n.data){g=n.data;if($.isFunction(n.data)){g=n.data.apply(i,[i.revert,n])}}else{g=i.revert}r.apply(d,[g,n,i]);f.attr('name',n.name);q.apply(d,[n,i]);$(i).append(d);o.apply(d,[n,i]);$(':input:visible:enabled:first',d).focus();if(n.select){f.select()}f.keydown(function(e){if(e.keyCode==27){e.preventDefault();u.apply(d,[n,i])}});var t;if('cancel'==n.onblur){f.blur(function(e){t=setTimeout(function(){u.apply(d,[n,i])},500)})}else if('submit'==n.onblur){f.blur(function(e){t=setTimeout(function(){d.submit()},200)})}else if($.isFunction(n.onblur)){f.blur(function(e){n.onblur.apply(i,[f.val(),n])})}else{f.blur(function(e){})}d.submit(function(e){if(t){clearTimeout(t)}e.preventDefault();if(false!==p.apply(d,[n,i])){if($.isFunction(n.target)){var b=n.target.apply(i,[f.val(),n]);$(i).html(b);i.editing=false;v.apply(i,[i.innerHTML,n]);if(!$.trim($(i).html())){$(i).html(n.placeholder)}}else{var c={};c[n.name]=f.val();c[n.id]=i.id;if($.isFunction(n.submitdata)){$.extend(c,n.submitdata.apply(i,[i.revert,n]))}else{$.extend(c,n.submitdata)}if('PUT'==n.method){c['_method']='put'}$(i).html(n.indicator);$.post(n.target,c,function(a){$(i).html(a);i.editing=false;v.apply(i,[i.innerHTML,n]);if(!$.trim($(i).html())){$(i).html(n.placeholder)}})}}return false})});this.reset=function(){$(i).html(i.revert);i.editing=false;if(!$.trim($(i).html())){$(i).html(n.placeholder)}}})};$.editable={types:{defaults:{element:function(a,b){var c=$('<input type="hidden"></input>');$(this).append(c);return(c)},content:function(a,b,c){$(':input:first',this).val(a)},reset:function(a,b){b.reset()},buttons:function(c,d){var e=this;if(c.submit){if(c.submit.match(/>$/)){var f=$(c.submit).click(function(){if(f.attr("type")!="submit"){e.submit()}})}else{var f=$('<button type="submit">');f.html(c.submit)}$(this).append(f)}if(c.cancel){if(c.cancel.match(/>$/)){var g=$(c.cancel)}else{var g=$('<button type="cancel">');g.html(c.cancel)}$(this).append(g);$(g).click(function(a){if($.isFunction($.editable.types[c.type].reset)){var b=$.editable.types[c.type].reset}else{var b=$.editable.types['defaults'].reset}b.apply(e,[c,d]);return false})}}},text:{element:function(a,b){var c=$('<input></input>');if(a.width!='none'){c.width(a.width)}if(a.height!='none'){c.height(a.height)}c.attr('autocomplete','off');$(this).append(c);return(c)}},textarea:{element:function(a,b){var c=$('<textarea>');if(a.rows){c.attr('rows',a.rows)}else{c.height(a.height)}if(a.cols){c.attr('cols',a.cols)}else{c.width(a.width)}$(this).append(c);return(c)}},select:{element:function(a,b){var c=$('<select>');$(this).append(c);return(c)},content:function(a,b,c){if(String==a.constructor){eval('var json = '+a);for(var d in json){if(!json.hasOwnProperty(d)){continue}if('selected'==d){continue}var e=$('<option>').val(d).append(json[d]);$('select',this).append(e)}}$('select',this).children().each(function(){if($(this).val()==json['selected']||$(this).text()==c.revert){$(this).attr('selected','selected')}})}}},addInputType:function(a,b){$.editable.types[a]=b}}})($);